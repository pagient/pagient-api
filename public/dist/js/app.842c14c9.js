(function(t){function e(e){for(var r,o,s=e[0],u=e[1],c=e[2],d=0,f=[];d<s.length;d++)o=s[d],i[o]&&f.push(i[o][0]),i[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={1:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var l=u;a.push([8,0]),n()})({8:function(t,e,n){t.exports=n("jn/H")},CDb3:function(t,e,n){},JPkn:function(t,e,n){},JUB3:function(t,e,n){},QOpM:function(t,e,n){},SCrg:function(t,e,n){"use strict";var r=n("QOpM"),i=n.n(r);i.a},TrO6:function(t,e,n){},UUxA:function(t,e,n){"use strict";var r=n("TrO6"),i=n.n(r);i.a},"btq+":function(t,e,n){},"jn/H":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"isLoggedIn",function(){return g}),n.d(r,"authToken",function(){return h}),n.d(r,"clients",function(){return m}),n.d(r,"pagers",function(){return b}),n.d(r,"patients",function(){return y}),n.d(r,"currentClient",function(){return P}),n.d(r,"currentPatient",function(){return w}),n.d(r,"patientByClient",function(){return _}),n.d(r,"patientByPager",function(){return C});var i={};n.r(i),n.d(i,"login",function(){return U}),n.d(i,"logout",function(){return M}),n.d(i,"getAllClients",function(){return D}),n.d(i,"getAllPagers",function(){return F}),n.d(i,"getAllPatients",function(){return H}),n.d(i,"callPatient",function(){return K}),n.d(i,"assignPager",function(){return J}),n.d(i,"selectClient",function(){return R});n("dE+T"),n("bHtr"),n("dRSK"),n("INYr"),n("HEwt"),n("Z2Ku"),n("yt8O"),n("6AQ9"),n("Vd3H"),n("0E+W"),n("yM4b"),n("IXt9"),n("f3/d"),n("9AAn"),n("fyVe"),n("U2t9"),n("2atp"),n("+auO"),n("MtdB"),n("Jcmo"),n("nzyx"),n("BC7C"),n("x8ZO"),n("9P93"),n("BJ/l"),n("eHKK"),n("pp/T"),n("CyHz"),n("bBoP"),n("x8Yj"),n("hLT2"),n("xfY5"),n("Ljet"),n("/KAi"),n("fN96"),n("7h0T"),n("sbF8"),n("h/M4"),n("knhD"),n("XfKG"),n("BP8U"),n("91GP"),n("RQRG"),n("/uf1"),n("/8Fb"),n("DW2E"),n("mYba"),n("jm62"),n("JduL"),n("5Pf0"),n("uaHG"),n("ZNX/"),n("mura"),n("25dN"),n("Zshi"),n("V/DX"),n("FlsD"),n("RW0V"),n("z2o2"),n("/SS/"),n("hhXQ"),n("VRzm"),n("CX2u"),n("3xty"),n("I5cv"),n("iMoV"),n("uhZd"),n("0YWM"),n("694e"),n("LTTk"),n("9rMk"),n("IlFx"),n("xpiv"),n("oZ/O"),n("klPD"),n("knU9"),n("Oyvg"),n("OEbY"),n("SRfc"),n("pIFo"),n("KKXr"),n("OG14"),n("a1Th"),n("T39b"),n("ioFf"),n("rE2o"),n("hEkN"),n("nIY7"),n("+oPb"),n("SMB2"),n("oDIu"),n("rvZc"),n("0mN4"),n("bDcW"),n("nsiH"),n("VpUO"),n("L9s1"),n("0LDn"),n("tUrg"),n("9XZr"),n("7VC1"),n("eI33"),n("FLlr"),n("84bF"),n("9VmF"),n("FEjr"),n("Zz4T"),n("JCqj"),n("xm80"),n("sFw1"),n("NO8f"),n("aqI/"),n("Faw5"),n("r1bV"),n("tuSo"),n("nCnK"),n("Y9lz"),n("Tdpu"),n("EK0E"),n("wCsR"),n("R5XZ"),n("Ew+T"),n("rGqo"),n("ls82");var a=n("Kw5r"),o=n("Hc5T"),s=n.n(o);a["default"].use(s.a);var u=n("zlta"),c=n.n(u),l=n("wKTU"),d=n.n(l);a["default"].use(c.a,{theme:{primary:d.a.orange.base,secondary:d.a.brown.darken1,accent:d.a.orange.darken4,error:d.a.deepOrange.base,warning:d.a.yellow.base,info:d.a.blue.base,success:d.a.green.base}});var f=n("L2JU");a["default"].use(f["a"]);var p=n("vDqi"),v=n.n(p),g=(n("sFTC"),function(t){return t.isLoggedIn}),h=function(t){return t.authToken},m=function(t,e){var n=Object.keys(t.clients);return n.length>0?n.map(function(n){var r=t.clients[n];return r.patient=e.patientByClient(r),r}):[]},b=function(t,e){var n=Object.keys(t.pagers);return n.length>0?n.map(function(n){var r=t.pagers[n];return r.patient=e.patientByPager(r),r}):[]},y=function(t){var e=Object.keys(t.patients);return e.length>0?e.map(function(e){return t.patients[e]}):[]},P=function(t){return t.currentClientId?t.clients[t.currentClientId]:{}},w=function(t,e){var n=P(t);return e.patientByClient(n)},_=function(t,e){return function(t){return e.patients.find(function(e){return e.clientId===t.id&&e.active})}},C=function(t,e){return function(t){return e.patients.find(function(e){return e.pagerId===t.id})}},k=n("XNqD"),x=n.n(k),O="/oauth/token";function $(t){return v.a.post(O,t)}function q(){return v.a.delete(O)}var j="/api/clients";function E(){return v.a.get(j)}var I="/api/pagers";function T(){return v.a.get(I)}var L="/api/patients";function S(){return v.a.get(L)}function B(t){return v.a.post(L+"/"+t.id,t)}function A(t){return v.a.delete(L+"/"+t.id)}var U=function(t,e){var n=t.commit;return $(e).then(function(t){n("login",t.data.token)})},M=function(t){var e=t.commit;return q().then(function(){e("logout")})},D=function(t){var e=t.commit;return E().then(function(t){e("receiveClients",t.data)})},F=function(t){var e=t.commit;return T().then(function(t){e("receivePagers",t.data)})},H=function(t){var e=t.commit;return S().then(function(t){e("receivePatients",t.data)})},K=function(t,e){if(e)return e=x()(e),e.status="call",B(e)},J=function(t,e){var n=e.patient,r=e.pager;if(n)return n=x()(n),n.status="pending",n.pagerId=r?r.id:null,B(n).then(function(){if(!n.active&&!n.pagerId)return A(n)})},R=function(t,e){var n=t.commit;n("switchClient",e)},G=n("yT7P"),Z={login:function(t,e){localStorage.setItem("token",e),t.isLoggedIn=!0,t.authToken=e},logout:function(t){localStorage.removeItem("token"),t.isLoggedIn=!1,t.authToken=null},receiveClients:function(t,e){e.forEach(function(e){t.clients[e.id]||V(t,e.id,e.name)})},receivePagers:function(t,e){e.forEach(function(e){t.pagers[e.id]||X(t,e.id,e.name)})},receivePatients:function(t,e){e.forEach(function(e){t.patients[e.id]||z(t,e.id,e)})},receivePatient:function(t,e){var n=t.patients[e.id];z(t,e.id,e),n&&n.ssn===e.ssn&&n.name===e.name&&n.clientId===e.clientId||N(t,e.clientId)},deletePatient:function(t,e){var n=t.patients;delete n[e.id],t.patients=Object(G["a"])({},n)},switchClient:function(t,e){N(t,e.id)}};function V(t,e,n){a["default"].set(t.clients,e,{id:e,name:n})}function X(t,e,n){a["default"].set(t.pagers,e,{id:e,name:n})}function z(t,e,n){a["default"].set(t.patients,e,n)}function N(t,e){t.currentClientId=e}var Y={isLoggedIn:!!localStorage.getItem("token"),authToken:localStorage.getItem("token"),currentClientId:null,clients:{},pagers:{},patients:{}},W=[];var Q=new f["a"].Store({state:Y,getters:r,actions:i,mutations:Z,plugins:W,strict:!1}),tt=n("jE9Z"),et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-xl":""}},[n("da-clients"),n("v-divider",{staticClass:"my-3"}),n("da-pagers")],1)},nt=[],rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:""}},t._l(t.clients,function(e){return n("v-flex",{key:e.id},[n("v-card",{attrs:{color:t.currentClient.id===e.id?"primary":void 0,dark:t.currentClient.id===e.id,height:"100%",hover:"",ripple:""},nativeOn:{click:function(n){t.selectClient(e)}}},[n("v-card-title",[n("div",[n("h3",{staticClass:"headline"},[t._v(t._s(e.name))]),e.patient?n("span",[t._v(t._s(e.patient.name)+" "),n("strong",[t._v(t._s(e.patient.ssn))])]):t._e()])])],1)],1)}))},it=[],at={methods:Object(f["b"])(["selectClient"]),computed:Object(f["c"])(["clients","currentClient"])},ot=at,st=n("KHd+"),ut=Object(st["a"])(ot,rt,it,!1,null,null,null),ct=ut.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"",wrap:""}},t._l(t.pagers,function(e){return n("v-flex",{key:e.id,staticClass:"custom-flex"},[n("v-card",{staticClass:"flex-card flex-column",attrs:{height:"100%",color:t.isPagerOverdue(e)?"error":void 0,dark:t.isPagerOverdue(e),hover:"",ripple:""},nativeOn:{click:function(n){t.assignPager({patient:t.currentPatient,pager:e})}}},[n("v-card-title",[n("div",[n("h3",{staticClass:"title font-weight-light"},[t._v(t._s(e.name))])])]),n("v-card-text",{staticClass:"grow py-0"},[e.patient?n("div",[t._v("\n            "+t._s(e.patient.name)),n("br"),n("strong",[t._v(t._s(e.patient.ssn))])]):t._e()]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{disabled:!e.patient,color:t.isPagerCalled(e)?"primary":void 0,dark:t.isPagerCalled(e),icon:"",large:""},on:{click:function(n){n.stopPropagation(),t.callPatient(e.patient)}}},[n("v-icon",{attrs:{medium:""}},[t._v("vibration")])],1),n("v-btn",{attrs:{disabled:!e.patient,icon:"",large:""},on:{click:function(n){n.stopPropagation(),t.assignPager({patient:e.patient,pager:null})}}},[n("v-icon",{attrs:{medium:""}},[t._v("check")])],1)],1)],1)],1)}))},dt=[],ft={methods:Object(G["a"])({},Object(f["b"])(["assignPager","callPatient"]),{isPagerCalled:function(t){return t.patient&&"called"===t.patient.status},isPagerOverdue:function(t){return t.patient&&"finished"===t.patient.status}}),computed:Object(f["c"])(["pagers","currentPatient"])},pt=ft,vt=(n("vucP"),Object(st["a"])(pt,lt,dt,!1,null,"31c01841",null)),gt=vt.exports,ht={components:{"da-clients":ct,"da-pagers":gt}},mt=ht,bt=(n("yiB/"),Object(st["a"])(mt,et,nt,!1,null,null,null)),yt=bt.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{staticClass:"text-xs-center",attrs:{xs4:""}},[n("v-avatar",{attrs:{tile:"",size:"100"}},[n("img",{attrs:{src:"/logo.png",alt:"Pagient Brand"}})]),n("v-card",{staticClass:"mt-2 text-xs-left"},[n("v-card-title",[n("h3",{staticClass:"headline mb-0"},[t._v("Login")])]),n("v-card-text",[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-alert",{staticClass:"mb-5",attrs:{value:t.requestError,color:"error",icon:"warning",outline:""}},[t._v("\n              "+t._s(t.requestError)+"\n            ")]),n("v-text-field",{attrs:{"error-messages":t.usernameErrors,label:"Username",required:""},on:{input:function(e){t.$v.credentials.username.$touch()},blur:function(e){t.$v.credentials.username.$touch()}},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),n("v-text-field",{attrs:{"append-icon":t.showPassword?"visibility_off":"visibility","error-messages":t.passwordErrors,type:t.showPassword?"test":"password",label:"Password",required:""},on:{"click:append":function(e){t.showPassword=!t.showPassword},input:function(e){t.$v.credentials.password.$touch()},blur:function(e){t.$v.credentials.password.$touch()}},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}}),n("v-btn",{staticClass:"primary",attrs:{type:"submit",disabled:!t.valid}},[t._v("Login")])],1)],1)],1)],1)],1)],1)},wt=[],_t=n("ta7f"),Ct={mixins:[o["validationMixin"]],validations:{credentials:{username:{required:_t["required"]},password:{required:_t["required"]}}},data:function(){return{valid:!0,requestError:"",credentials:{username:"",password:""},showPassword:!1}},computed:{usernameErrors:function(){var t=[];return this.$v.credentials.username.$dirty?(!this.$v.credentials.username.required&&t.push("Username is required"),t):t},passwordErrors:function(){var t=[];return this.$v.credentials.password.$dirty?(!this.$v.credentials.password.required&&t.push("Password is required"),t):t}},methods:{login:function(){var t=this;this.$v.$touch(),this.requestError="",this.$store.dispatch("login",this.credentials).then(function(){var e=t.$route.query.redirect?t.$route.query.redirect:"/";t.$router.push(e)}).catch(function(e){e.response?401!==e.response.status?t.requestError=e.response.statusText:t.requestError="Username or password wrong!":t.requestError=e.message})}}},kt=Ct,xt=(n("UUxA"),Object(st["a"])(kt,Pt,wt,!1,null,"d26604ea",null)),Ot=xt.exports,$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-jumbotron",[n("v-container",{attrs:{"fill-height":"","text-xs-center":""}},[n("v-layout",{attrs:{"align-center":""}},[n("v-flex",[n("h3",{staticClass:"display-1 mb-4"},[t._v("It seems that you tried to enter a page that requires you to be logged out!")]),n("span",{staticClass:"subheading"},[t._v("Either logout or go back to "),n("router-link",{attrs:{to:"/"}},[t._v("Home")]),t._v(" if you didn't intend to do this.")],1),n("v-divider",{staticClass:"my-3"}),n("div",{staticClass:"title mb-2"},[n("v-btn",{staticClass:"primary",on:{click:t.logout}},[t._v("Logout")])],1)],1)],1)],1)],1)},qt=[],jt={methods:{logout:function(){var t=this;this.$store.dispatch("logout").then(function(){var e=t.$route.query.redirect?t.$route.query.redirect:"/login";t.$router.push(e)})}}},Et=jt,It=(n("SCrg"),Object(st["a"])(Et,$t,qt,!1,null,"4cf539d9",null)),Tt=It.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-jumbotron",[n("v-container",{attrs:{"fill-height":"","text-xs-center":""}},[n("v-layout",{attrs:{"align-center":""}},[n("v-flex",[n("h3",{staticClass:"display-1 mb-4"},[t._v("We are sorry, but we could not find the page")]),n("span",{staticClass:"subheading"},[t._v(t._s(t.requestedPath)+" not available")]),t._v(",\n        "),n("v-divider",{staticClass:"my-3"}),n("div",{staticClass:"title mb-2"},[t._v("\n          Go back to "),n("router-link",{attrs:{to:"/"}},[t._v("Home")]),t._v("!\n        ")],1)],1)],1)],1)],1)},St=[],Bt={computed:{requestedPath:function(){return this.$route.path}}},At=Bt,Ut=(n("pGGl"),Object(st["a"])(At,Lt,St,!1,null,"771b864f",null)),Mt=Ut.exports;a["default"].use(tt["a"]);var Dt=[{path:"/",component:yt,meta:{requiresAuth:!0}},{path:"/login",component:Ot,meta:{guestOnly:!0}},{path:"/logout",component:Tt,meta:{requiresAuth:!0}},{path:"*",component:Mt}],Ft=new tt["a"]({routes:Dt});Ft.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.requiresAuth})&&(Q.getters.isLoggedIn||n({path:"/login",query:{redirect:"/logout"!==t.fullPath?t.fullPath:"/"}})),n()}),Ft.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.guestOnly})&&Q.getters.isLoggedIn&&n({path:"/logout",query:{redirect:t.fullPath}}),n()});var Ht=Ft;v.a.interceptors.request.use(function(t){var e=Q.getters.authToken;return e&&(t.headers.Authorization="Bearer ".concat(e)),t},function(t){return Promise.reject(t)}),v.a.interceptors.response.use(function(t){return t},function(t){return t.response&&401===t.response.status&&"/login"!==Ht.currentRoute.path&&(Q.commit("logout"),Ht.push({path:"/login",query:{redirect:Ht.currentRoute.fullPath}})),Promise.reject(t)});var Kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-content",[n("router-view")],1)],1)},Jt=[];function Rt(t){return function(e){t.addEventListener("open",function(){e.dispatch("getAllClients").then(function(){return e.dispatch("getAllPagers")}).then(function(){return e.dispatch("getAllPatients")}).then(function(){t.addEventListener("message",function(t){var n=t.data,r=JSON.parse(n);switch(r.type){case"patient_add":case"patient_update":e.commit("receivePatient",r.data);break;case"patient_delete":e.commit("deletePatient",r.data);break}})})})}}var Gt={name:"app",mounted:function(){var t=this,e=function(){var e=t.$store.subscribe(function(t,r){("login"===t.type||r.isLoggedIn)&&(n(r.authToken),e())})},n=function(n){var r="ws://".concat(location.host,"/ws"),i=new WebSocket("".concat(r,"?jwt=").concat(n));i.onclose=function(n){if(1006===n.code)return e(),t.$store.commit("logout"),void("/login"!==t.$router.currentRoute.path&&t.$router.push({path:"/login",query:{redirect:t.$router.currentRoute.fullPath}}))},Rt(i)(t.$store)};this.$store.getters.isLoggedIn?n(this.$store.getters.authToken):e()}},Zt=Gt,Vt=(n("k5+k"),Object(st["a"])(Zt,Kt,Jt,!1,null,null,null)),Xt=Vt.exports;n("JPkn");a["default"].config.productionTip=!1,new a["default"]({router:Ht,store:Q,render:function(t){return t(Xt)}}).$mount("#app")},"k5+k":function(t,e,n){"use strict";var r=n("JUB3"),i=n.n(r);i.a},pGGl:function(t,e,n){"use strict";var r=n("btq+"),i=n.n(r);i.a},vucP:function(t,e,n){"use strict";var r=n("CDb3"),i=n.n(r);i.a},xix5:function(t,e,n){},"yiB/":function(t,e,n){"use strict";var r=n("xix5"),i=n.n(r);i.a}});
//# sourceMappingURL=app.842c14c9.js.map